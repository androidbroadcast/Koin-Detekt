# Release 1.0.0 Prep Design

**Date:** 2026-02-19

**Goal:** Clean the repository of internal development artifacts and add automatic README version updates to the release pipeline.

---

## Part 1: Repository Cleanup

### Files to remove from git

| File | Reason |
|------|--------|
| `pr-review-response.md` | One-time PR review response |
| `docs/edge-cases-task7-completed.md` | Internal task artifact |
| `docs/future-rule-ideas.md` | After migrating to GitHub Issues |
| `docs/plans/` (23 files) | Internal development plans |

### GitHub Issues to create from future-rule-ideas.md

Before deleting `docs/future-rule-ideas.md`, create GitHub issues for actionable ideas not yet tracked:

1. **ScopedViewComponentLeak** — scoped Adapter/View in Fragment scope leaks view references after `onDestroyView` (Koin#1144, #1122)
2. **CircularGetDependency** — extend CircularModuleDependency to detect `get<A>()` → `get<B>()` → `get<A>()` cycles at definition level (Koin#334, #2041)
3. **AndroidContextAccessOutsideModuleDefinition** — direct Context access outside module (low priority, may overlap with existing rule)
4. **MissingAndroidContextInModuleVerification** — `checkModules()` fails when module uses `androidContext()` without test mock (Koin#553)

Skip (not actionable): Stacked Parameters, KoinApplication Not Started, by inject() KOIN_CONFIG_CHECK, Generic Type Validation, ViewModel Factory Enforcement.

### .gitignore update

Add `docs/plans/` to `.gitignore` so future plan files don't accidentally get committed.

---

## Part 2: Release Pipeline — README Auto-Update

### Where to add

In `.github/workflows/release.yml`, job `release`, after the existing "Update and commit CHANGELOG to main" step.

### New step

```yaml
- name: Update README version on main
  continue-on-error: true
  run: |
    VERSION="${GITHUB_REF#refs/tags/v}"

    git config user.name "github-actions[bot]"
    git config user.email "github-actions[bot]@users.noreply.github.com"

    git fetch origin main
    git checkout main

    # Idempotency: skip if version already updated
    if grep -q "detekt-koin4-rules:${VERSION}" README.md; then
      echo "README already shows version ${VERSION}, skipping"
      exit 0
    fi

    sed -i "s/detekt-koin4-rules:[0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*/detekt-koin4-rules:${VERSION}/g" README.md

    git add README.md

    if git diff --staged --quiet; then
      echo "No changes to commit"
    else
      git commit -m "chore: update README installation version to ${VERSION}"
      git push origin main
      echo "✅ README updated to version ${VERSION}"
    fi
```

### Key properties
- `continue-on-error: true` — same pattern as CHANGELOG step, don't fail release on doc update error
- Idempotency check — skip if version already in README
- Uses regex `[0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*` (POSIX-compatible, works on macOS and Linux sed)

---

## Implementation Order

1. Create GitHub Issues from future-rule-ideas.md
2. Remove cleanup files (`git rm`)
3. Update `.gitignore`
4. Add README update step to release.yml
5. Commit and push
